<!DOCTYPE html>
<html>
<head>
  <title>Sudoku online spielen - kostenlos</title>
  <link rel="stylesheet" type="text/css" href="style.css">
  <link rel="icon" type="image/x-icon" href="favicon.png">
</head>

<body>
  <div class="header">
      <a href="/">Startseite</a>
  </div>&nbsp

  <div>
    <p>Zeit: 0:00 | Fehler: 0/3</p>
  </div>

  <div class="crossword" id="printableArea">
    <div class="row">
      <input class="input-field" id="0" name="0" type="sudoku-top-left" maxlength="1">
      <input class="input-field" id="1" type="sudoku-top" maxlength="1">
      <input class="input-field" id="2" type="sudoku-top" maxlength="1">
      <input class="input-field" id="3" type="sudoku-top-left" maxlength="1">
      <input class="input-field" id="4" type="sudoku-top" maxlength="1">
      <input class="input-field" id="5" type="sudoku-top" maxlength="1">
      <input class="input-field" id="6" type="sudoku-top-left" maxlength="1">
      <input class="input-field" id="7" type="sudoku-top" maxlength="1">
      <input class="input-field" id="8" type="sudoku-top-right" maxlength="1">
    </div>
    <div class="row">
      <input class="input-field" id="9" type="sudoku-left" maxlength="1">
      <input class="input-field" id="10" type="sudoku" maxlength="1">
      <input class="input-field" id="11" type="sudoku-right" maxlength="1">
      <input class="input-field" id="12" type="sudoku" maxlength="1">
      <input class="input-field" id="13" type="sudoku" maxlength="1">
      <input class="input-field" id="14" type="sudoku-right" maxlength="1">
      <input class="input-field" id="15" type="sudoku" maxlength="1">
      <input class="input-field" id="16" type="sudoku" maxlength="1">
      <input class="input-field" id="17" type="sudoku-right" maxlength="1">
    </div>    
    <div class="row">
      <input class="input-field" id="18" type="sudoku-bottom-left" maxlength="1">
      <input class="input-field" id="19" type="sudoku-bottom" maxlength="1">
      <input class="input-field" id="20" type="sudoku-bottom-right" maxlength="1">
      <input class="input-field" id="21" type="sudoku-bottom" maxlength="1">
      <input class="input-field" id="22" type="sudoku-bottom" maxlength="1">
      <input class="input-field" id="23" type="sudoku-bottom-right" maxlength="1">
      <input class="input-field" id="24" type="sudoku-bottom" maxlength="1">
      <input class="input-field" id="25" type="sudoku-bottom" maxlength="1">
      <input class="input-field" id="26" type="sudoku-bottom-right" maxlength="1">
    </div>    
    <div class="row">
      <input class="input-field" id="27" type="sudoku-left" maxlength="1">
      <input class="input-field" id="28" type="sudoku" maxlength="1">
      <input class="input-field" id="29" type="sudoku" maxlength="1">
      <input class="input-field" id="30" type="sudoku-left" maxlength="1">
      <input class="input-field" id="31" type="sudoku" maxlength="1">
      <input class="input-field" id="32" type="sudoku" maxlength="1">
      <input class="input-field" id="33" type="sudoku-left" maxlength="1">
      <input class="input-field" id="34" type="sudoku" maxlength="1">
      <input class="input-field" id="35" type="sudoku-right" maxlength="1">
    </div>    
    <div class="row">
      <input class="input-field" id="36" type="sudoku-left" maxlength="1">
      <input class="input-field" id="37" type="sudoku" maxlength="1">
      <input class="input-field" id="38" type="sudoku-right" maxlength="1">
      <input class="input-field" id="39" type="sudoku" maxlength="1">
      <input class="input-field" id="40" type="sudoku" maxlength="1">
      <input class="input-field" id="41" type="sudoku-right" maxlength="1">
      <input class="input-field" id="42" type="sudoku" maxlength="1">
      <input class="input-field" id="43" type="sudoku" maxlength="1">
      <input class="input-field" id="44" type="sudoku-right" maxlength="1">
    </div>   
    <div class="row">
      <input class="input-field" id="45" type="sudoku-bottom-left" maxlength="1">
      <input class="input-field" id="46" type="sudoku-bottom" maxlength="1">
      <input class="input-field" id="47" type="sudoku-bottom-right" maxlength="1">
      <input class="input-field" id="48" type="sudoku-bottom" maxlength="1">
      <input class="input-field" id="49" type="sudoku-bottom" maxlength="1">
      <input class="input-field" id="50" type="sudoku-bottom-right" maxlength="1">
      <input class="input-field" id="51" type="sudoku-bottom" maxlength="1">
      <input class="input-field" id="52" type="sudoku-bottom" maxlength="1">
      <input class="input-field" id="53" type="sudoku-bottom-right" maxlength="1">
    </div>    
    <div class="row">
      <input class="input-field" id="54" type="sudoku-left" maxlength="1">
      <input class="input-field" id="55" type="sudoku" maxlength="1">
      <input class="input-field" id="56" type="sudoku" maxlength="1">
      <input class="input-field" id="57" type="sudoku-left" maxlength="1">
      <input class="input-field" id="58" type="sudoku" maxlength="1">
      <input class="input-field" id="59" type="sudoku" maxlength="1">
      <input class="input-field" id="60" type="sudoku-left" maxlength="1">
      <input class="input-field" id="61" type="sudoku" maxlength="1">
      <input class="input-field" id="62" type="sudoku-right" maxlength="1">
    </div>    
    <div class="row">
      <input class="input-field" id="63" type="sudoku-left" maxlength="1">
      <input class="input-field" id="64" type="sudoku" maxlength="1">
      <input class="input-field" id="65" type="sudoku-right" maxlength="1">
      <input class="input-field" id="66" type="sudoku" maxlength="1">
      <input class="input-field" id="67" type="sudoku" maxlength="1">
      <input class="input-field" id="68" type="sudoku-right" maxlength="1">
      <input class="input-field" id="69" type="sudoku" maxlength="1">
      <input class="input-field" id="70" type="sudoku" maxlength="1">
      <input class="input-field" id="71" type="sudoku-right" maxlength="1">
    </div>   
    <div class="row">
      <input class="input-field" id="72" type="sudoku-bottom-left" maxlength="1">
      <input class="input-field" id="73" type="sudoku-bottom" maxlength="1">
      <input class="input-field" id="74" type="sudoku-bottom-right" maxlength="1">
      <input class="input-field" id="75" type="sudoku-bottom" maxlength="1">
      <input class="input-field" id="76" type="sudoku-bottom" maxlength="1">
      <input class="input-field" id="77" type="sudoku-bottom-right" maxlength="1">
      <input class="input-field" id="78" type="sudoku-bottom" maxlength="1">
      <input class="input-field" id="79" type="sudoku-bottom" maxlength="1">
      <input class="input-field" id="80" name="80" type="sudoku-bottom-right" maxlength="1">
    </div>
  </div>&nbsp

  <div>
    <button onclick="generateSudoku()">Neues Sudoku</button>&nbsp
    <button onclick="lÃ¶sen()">Sudoku lÃ¶sen</button>&nbsp
    <button onclick="printDiv('printableArea')">Sudoku drucken</button>&nbsp
  </div>&nbsp

</body>

<footer>
    <div>
        <a href="/datenschutz">Datenschutz</a>
        <a href="/impressum">Impressum</a>
        <a href="/" >ðŸ‡¬ðŸ‡§ English Version</a>
    </div>
</footer>
</html>

<script>

///////////////////////////////////////////////////////////////////////////////////////////////////////////////// Alles zum Input loggen ///////////////////////////////////////////////////////////

function checkInputFields() {
  const inputFields = document.querySelectorAll('.input-field');
  let sudoku = formattedString;

  for (let i = 0; i < inputFields.length; i++) {
    if (inputFields[i].value !== '') {
      // An input field has been filled out
      const filledField = inputFields[i];
      const fieldValue = filledField.value;
      const fieldIndex = i + 1;

      // Validate the move
      if (isValidMove(sudoku, i, fieldValue)) {
        // Update the sudoku string with the input number
        sudoku = sudoku.substr(0, i) + fieldValue + sudoku.substr(i + 1);

        console.log(`Input field ${fieldIndex} has been filled out. Value: ${fieldValue}`);
        console.log('Updated Sudoku:', sudoku);
      } else {
        console.log(`Input field ${fieldIndex} contains an invalid move. Value: ${fieldValue}`);
      }

      return;
    }
  }

  // No input fields have been filled out
  console.log('No input fields have been filled out.');
  console.log('Sudoku:', sudoku);
}

function isValidMove(sudoku, index, value) {
  const row = Math.floor(index / 9);
  const col = index % 9;

  // Check the row
  for (let i = 0; i < 9; i++) {
    if (sudoku[row * 9 + i] === value) {
      return false; // Invalid move: value already exists in the row
    }
  }

  // Check the column
  for (let i = 0; i < 9; i++) {
    if (sudoku[col + i * 9] === value) {
      return false; // Invalid move: value already exists in the column
    }
  }

  // Check the 3x3 grid
  const gridRow = Math.floor(row / 3) * 3;
  const gridCol = Math.floor(col / 3) * 3;
  for (let i = 0; i < 3; i++) {
    for (let j = 0; j < 3; j++) {
      if (sudoku[(gridRow + i) * 9 + gridCol + j] === value) {
        return false; // Invalid move: value already exists in the 3x3 grid
      }
    }
  }

  return true; // Valid move
}

// Call the function periodically using setInterval
setInterval(checkInputFields, 1000); // Adjust the interval as needed (in milliseconds)



///////////////////////////////////////////////////////////////////////////////////////////////////////////////// Alles zum ausdrucken //////////////////////////////////////////////////////////////

function printDiv(divName) {
     var printContents = document.getElementById(divName).innerHTML;
     var originalContents = document.body.innerHTML;

     document.body.innerHTML = printContents;

     window.print();

     document.body.innerHTML = originalContents;
}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////// Alles zum den schwierinkeiten //////////////////////////////////////////////////////////////

function getRndInteger(min, max) {
  return Math.floor(Math.random() * (max - min + 1) ) + min;
}

var leicht = getRndInteger(35, 38)
var mittel = getRndInteger(29, 34)
var schwer = getRndInteger(23, 28)
var experte = getRndInteger(18, 22)

///////////////////////////////////////////////////////////////////////////////////////////////////////////////// Alles zum generieren ///////////////////////////////////////////////////////////////

var puzzle
var formattedString

function generateSudoku() {

  for (let i = 0; i <= 80; i++) {
        document.getElementById(i.toString()).placeholder = "";
        document.getElementById(i.toString()).style.pointerEvents = "all"
        document.getElementById(i.toString()).value = ""
    }

  puzzle = generateSudokuGrid()
  var sudoku = String(puzzle)

  formattedString = sudoku.split(" ").join("").split(",").join("").split("[").join("").split("]").join("").replace(/\s/g, '');

  for (let i = 0; i <= 80; i++) {
      if (formattedString[i] !== "0") {
          document.getElementById(i.toString()).placeholder = formattedString[i];
          document.getElementById(i.toString()).style.pointerEvents = "none"
        }
    }

}

function generateSudokuGrid() {
  const grid = Array.from({ length: 9 }, () => Array(9).fill(0));

  // Fill the diagonal 3x3 subgrids with random values
  for (let i = 0; i < 9; i += 3) {
    fillSubgrid(grid, i, i);
  }

  // Solve the Sudoku grid
  solveSudoku(grid);

  // Remove random cells to create a puzzle
  const puzzleGrid = removeCells(grid);

  return puzzleGrid;
}

function fillSubgrid(grid, startRow, startCol) {
  const values = shuffle([1, 2, 3, 4, 5, 6, 7, 8, 9]);

  let valueIndex = 0;
  for (let row = startRow; row < startRow + 3; row++) {
    for (let col = startCol; col < startCol + 3; col++) {
      grid[row][col] = values[valueIndex];
      valueIndex++;
    }
  }
}

function shuffle(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

function solveSudoku(grid) {
  const emptyCell = findEmptyCell(grid);
  if (!emptyCell) {
    return true; // Sudoku grid solved
  }

  const [row, col] = emptyCell;

  for (let num = 1; num <= 9; num++) {
    if (isValidMove(grid, row, col, num)) {
      grid[row][col] = num;

      if (solveSudoku(grid)) {
        return true;
      }

      grid[row][col] = 0; // Backtrack
    }
  }

  return false; // Sudoku grid unsolvable
}

function findEmptyCell(grid) {
  for (let row = 0; row < 9; row++) {
    for (let col = 0; col < 9; col++) {
      if (grid[row][col] === 0) {
        return [row, col];
      }
    }
  }
  return null; // No empty cell found
}

function isValidMove(grid, row, col, num) {
  return (
    isRowValid(grid, row, num) &&
    isColumnValid(grid, col, num) &&
    isSubgridValid(grid, row - (row % 3), col - (col % 3), num)
  );
}

function isRowValid(grid, row, num) {
  for (let col = 0; col < 9; col++) {
    if (grid[row][col] === num) {
      return false;
    }
  }
  return true;
}

function isColumnValid(grid, col, num) {
  for (let row = 0; row < 9; row++) {
    if (grid[row][col] === num) {
      return false;
    }
  }
  return true;
}

function isSubgridValid(grid, startRow, startCol, num) {
  for (let row = 0; row < 3; row++) {
    for (let col = 0; col < 3; col++) {
      if (grid[startRow + row][startCol + col] === num) {
        return false;
      }
    }
  }
  return true;
}

function removeCells(grid) {
  const difficulty = 40; // Adjust the number of cells to remove as per desired difficulty

  for (let i = 0; i < difficulty; i++) {
    let row, col;
    do {
      row = Math.floor(Math.random() * 9);
      col = Math.floor(Math.random() * 9);
    } while (grid[row][col] === 0);

    grid[row][col] = 0;
  }

  return grid;
}

function formatSudoku() {

  var sudoku = "";
  for (var i = 0; i <= 80; i++) {
    sudoku += number[i] + " ";
    if (i % 3 === 2 && i % 9 !== 8) {
      sudoku += "| ";
    }
    if (i % 9 === 8 && i !== 80) {
      sudoku += "\n";
      if (i % 27 === 26) {
        sudoku += "------+-------+------\n";
      }
    }
  }
}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////// Alles zum LÃ¶sen ////////////////////////////////////////////////////////////////////////

// This code has been (mostly) generated by ChatGPT.
// Minor modifications were made to provide ES6 syntax (let/const)
// and use true equality operators (== -> ===)
// That's about it.

function solveSudoku(grid) {
  // Find the next empty cell in the puzzle
  const emptyCell = findEmptyCell(grid);

  // If there are no more empty cells, the puzzle is solved
  if (!emptyCell) {
    return true;
  }

  // Try each possible value for the empty cell
  for (let i = 1; i <= 9; i++) {
    // If the value is valid for the empty cell, fill it in and
    // try to solve the rest of the puzzle
    if (isValidValue(grid, emptyCell, i)) {
      grid[emptyCell.row][emptyCell.col] = i;
      if (solveSudoku(grid)) {
        return true;
      }
    }
  }

  // If none of the values work, backtrack and try a different value
  grid[emptyCell.row][emptyCell.col] = 0;
  return false;
}

function findEmptyCell(grid) {
  // Search the grid for the next empty cell
  for (let i = 0; i < 9; i++) {
    for (let j = 0; j < 9; j++) {
      if (grid[i][j] === 0) {
        return { row: i, col: j };
      }
    }
  }

  // If there are no more empty cells, return null
  return null;
}

function isValidValue(grid, cell, value) {
  // Check if the value is already used in the row
  for (let i = 0; i < 9; i++) {
    if (grid[cell.row][i] === value) {
      return false;
    }
  }

  // Check if the value is already used in the column
  for (let i = 0; i < 9; i++) {
    if (grid[i][cell.col] === value) {
      return false;
    }
  }

  // Check if the value is already used in the 3x3 block
  const blockRow = Math.floor(cell.row / 3) * 3;
  const blockCol = Math.floor(cell.col / 3) * 3;
  for (let i = 0; i < 3; i++) {
    for (let j = 0; j < 3; j++) {
      if (grid[blockRow + i][blockCol + j] === value) {
        return false;
      }
    }
  }

  // If the value is not used in the row, column, or block, it is valid
  return true;
}

function lÃ¶sen() {
  solveSudoku(puzzle);
  var formattedString = String(puzzle).split(" ").join("").split(",").join("").split("[").join("").split("]").join("").replace(/\s/g, '');

  for (let i = 0; i <= 80; i++) {
      if (formattedString[i] !== "0") {
          document.getElementById(i.toString()).placeholder = formattedString[i];
          document.getElementById(i.toString()).style.pointerEvents = "none"
        }
    }
}

</script>